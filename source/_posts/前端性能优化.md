---
title: 前端性能优化
date: 2019-03-21
updated: 2019-06-03
tags: web 
categories: 前端性能优化
keywords: 前端性能优化
description: 前端性能优化
top_img:
comments: false
cover:
toc:
toc_number:
copyright:
copyright_author:
copyright_author_href:
copyright_url:
copyright_info:
mathjax:
katex:
aplayer:
highlight_shrink:
aside:
---
# 前端性能优化

## 从输入url 到页面加载完成 发生了什么

```JS
1.用户在地址栏上输入访问地址
2.浏览器通过DNS(网络服务)解析 把url解析为IP
3.和IP建立tCP(三次握手什么的)链接 然后发送http请求
4.服务器收到请求 查库 读文件等 拼接好返回的http响应
5.浏览器收到首屏的html 开始渲染
6.解析html为DOM 解析css 为css-tree
7.dom + css tree 生成render树 开始告诉电脑cpu按照render树执行
8.加载script的js文件
9.执行js
```

## 优化的两大方向

```JS
1.少加载文件 文件打包压缩 图片格式压缩 缓存 CDN缩减距离 提高加载速度 ssr(首页文件执行顺序) lazy-load(懒加载)
2.少执行代码 
```

## DNS

```JS
1.查看dns缓存
2.本地没有缓存 发起dns请求 像本地配置DNS服务器发请求(递归)
```

## 网络协议

```JS
1.网络协议就是让机器聊天
首先你要知道目标是谁 这个时候就是用我们的IP协议 负责寻址 这里我只负责找到是谁 至于你的内容怎么发出去我就不管了
2.IP寻址之后 知道是谁了 然后就是我们的TCP(基于IP)协议 负责数据的完整和有序 和送到消息
这里为了保证完整的数据有序 和 送到消息 做了很多的事情 比如三次握手(也是会造成网络延迟) 当然还有一些 重发 滑动窗口 粘包 慢启动等机制 TCP协议 是操作系统自带的
3.HTTP协议 基于TCP协议 负责应用层 具体由header 和 body构成
4.UDP 也是基于IP的 只管收发 不管数据丢不丢(没有tcp那么多的限制 所以性能好)
适合场景 游戏 语音视频聊天 DNS 
```

## 缓存

```JS
1.其实就是网络缓存 我们在发送请求的时候 请求头 和响应头会自带一些信息 这里面就由是否缓存 如果缓存 在什么时间用缓存 什么时间缓存失效 都可以设置 
2.抽象的理解就是我们在发送http请求的时候 把请求的内容都存放在内存中了 然后当我在发送同样的请求的时候 先去看看我们的当时返回的缓存是怎么设置的 比如 九点之后 如果你在发送相同的请求 就走缓存 获取内容 就不用你在重新发送http请求了 比如 可以询问服务器 我这个文件动没动过之类的
2.强缓存 我们缓存数据生效的情况下 不需要和服务器交互 直接使用
3.弱缓存 缓存数据失效了 需要问下服务器 还能不能用缓存
4.强缓存还是弱缓存 是服务器配置
```

```JS
用户请求浏览器一个图片 (可以设置缓存策略, cache-control字段)
no-catch 先和服务器确认一下 是否由 
no-store 禁止浏览器的返回缓存都不记得
max-age 允许使用的时间 单位是s
后端返回一个图片
```

## 怎么利用好缓存

```JS
1.HTML 使用 no-cache
2.文件夹指纹 并修改文件名xx.2324.js
3.静态资源都在cdn 专门的cdn域名 cdn 缩短了用户和服务器的距离 提升加载效率 浏览器对同一个域名的并发数有限制 所以用cdn加载静态资源
```

## cdn

```JS
1.原理s
比如我有一个服务器在北京 上面有一个图片 
然后广州一个哥们想看这个图片 
这个时候 由于距离比较远 就会经过很多的交换机 路由器去中转 所以就会很耗时
所以这个是时候 就是cdn 把图片 部署在各大的机房 比如上海杭州广州成都西安 用户访问呢的时候 返回离你最近的图片地址
```

 

